---
title: "Physical Ability Test Estimator"
author: "Carlos Valle"
date: "May 11, 2016"
output: html_document
runtime: shiny
---

The VPAT is a test battery comprised of a:
.	75 Yard Obstacle Course (time to complete)
.	1.5 Mile Run (time to complete)
.	Push ups (number of push ups)
.	Arm Endurance (number of revolutions)
.	Sit up (number of push ups)

Enter your numbers for each componenty by using the sliders for each VPAT activity below. 

Then, view your estimate a score (green line) and comparison to prior test-takers and the pass-point.


```{r, echo=FALSE}
normal <- function(x, mu = -4.4429, sigma = 30.4165) {
  # x: values on x-axis
  # mu: mean value
  # sigma: standard deviation
  
  # output
  1 / (sigma * sqrt(2*pi)) * exp(-0.5 * ((x - mu)/ sigma)^2)
}


inputPanel(

  sliderInput("pushups", label = "Push Ups:",
              min = 1, max = 100, value = 29, step = 1),
  sliderInput("in_75yard", label = "75Yard Obstacle Time (secs.):",
              min = 5, max = 40, value = 17, step = 1),
  sliderInput("armend", label = "Arm Endurance:",
              min = 1, max = 200, value = 130, step = 1),
  sliderInput("situps", label = "Sit Ups:",
              min = 1, max = 100, value = 37, step = 1),  
  sliderInput("oneplushalf", label = "1.5 Mile Run Time(mins.):",
              min = 5, max = 60, value = 15, step = 0.25)
)

renderPlot({
  pushupsz <- (as.numeric(input$pushups)-29.679)/17.438
  onstaclez<- (as.numeric(input$in_75yard) - 17.634)/-1.629
  armendz <- (as.numeric(input$armend)-130.463)/20.525
  situpsz <- (as.numeric(input$situps)-36.44)/10.824
  onehalfz<- ((as.numeric(input$oneplushalf))-14.689)/-2.647
  score <-  (pushupsz + armendz + situpsz) + (onstaclez*3) + (onehalfz*6)
  if (score>=-6.17) status<- "Pass" else  status<- "Fail"


x <- seq(-110, 110, length.out = 500)
y  <- dnorm(x, mean = -.07, sd = 10.7)

# normal curve plot
op = par(font.axis = 2) 
plot(x, y, type = 'l', col = '#ff7633', lwd = 3, main="VPAT Results Estimator", xlab = paste("Status: ", status,"|", "Score: ", round(score,1)),xlim=c(-110, 110))
mtext("Passpoint", at = -6.17, line = -10)
abline(v=-6.17)
abline(v=score,col=3,lty=3, size = 4)



})
```




